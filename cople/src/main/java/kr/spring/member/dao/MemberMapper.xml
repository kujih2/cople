<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.spring.member.dao.MemberMapper">
	<!-- 회원가입 상세 -->
	<insert id="insertMember_detail" parameterType="memberVO">
		INSERT INTO member_detail (
		   mem_num,
		   name,
		   passwd,
		   phone,
		   email,
		   birth,
		   gender,
		   zipcode,
		   address1,
		   address2,
		   push,
		   certify_photo_name)
		VALUES (
		   #{mem_num},
		   #{name},
		   #{passwd},
		   #{phone},
		   #{email},
		   #{birth},
		   #{gender},
		   #{zipcode},
		   #{address1},
		   #{address2},
		   #{push},
		   #{certify_photo_name}
		   )   
	</insert>
	
	<!-- 아이디 중복 체크 및 로그인 체크 -->
	<select id="selectCheckMember" parameterType="string">
		SELECT
		   mem_num,
		   id,
		   auth,
		   nick_name,
		   au_id,
		   passwd,
		   email,
		   name
		FROM member LEFT OUTER JOIN member_detail
		USING(mem_num)
		WHERE id=#{id}
	</select>
	
	<!-- 회원 전체 목록/검색 목록 -->
	<select id="selectList" parameterType="map" resultType="memberVO">
    SELECT
        m.mem_num,
        m.id,
        m.name,
        md.phone,
        md.email,
        md.reg_date
    FROM (
        SELECT
            a.*,
            rownum rnum
        FROM (
            SELECT
                mem_num,
                id,
                name
            FROM member
            <include refid="memberSearch"></include>
            <include refid="memberOrder"></include>
        ) a
    )
    LEFT OUTER JOIN member_detail md ON m.mem_num = md.mem_num
    <![CDATA[
    WHERE rnum >= #{start} AND rnum <= #{end}
    ]]>
</select>


</mapper>